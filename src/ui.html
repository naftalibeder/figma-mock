<div id="textLabel">Enter your text</div>
<textarea id="list" rows="5" placeholder="Put separate items on a new line"></textarea>
<div id="optionsLabel">Choose what to fill</div>
<div id="options" style="display: block;"></div>
<button id="confirm">Fill</button>
<button id="cancel">Cancel</button>

<script>
  onmessage = event => {
    const msg = event.data.pluginMessage;

    if (msg.type === 'init') {
      const uniqueContents = msg.uniqueContents;
      const container = document.getElementById('options');

      if (uniqueContents.length === 0) { // show a no data message
        container.textContent="You haven't selected anything, yet.";
      } else {
        uniqueContents.forEach(contents => {
          const option = document.createElement('div');
          container.appendChild(option);
  
          const radio = document.createElement('input');
          radio.type = 'radio';
          radio.name = 'option';
          radio.value = contents;
          option.appendChild(radio);
  
          const label = document.createElement('label');
          label.innerHTML = contents;
          option.appendChild(label);
        })
      }
    }
  };

  document.getElementById('confirm').onclick = () => {
    const listInput = document.getElementById('list');
    const listText = listInput.value;

    const options = [...document.getElementsByName('option')];
    const selected = options.filter(field => field.checked)[0];
    const selectionText = selected.value;

    parent.postMessage({ pluginMessage: { type: 'confirm', listText, selectionText } }, '*');
  };

  document.getElementById('cancel').onclick = () => {
    parent.postMessage({ pluginMessage: { type: 'cancel' } }, '*');
  };

  parent.postMessage({ pluginMessage: { type: 'init' } }, '*');
</script>

